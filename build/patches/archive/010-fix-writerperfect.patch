diff --git a/writerperfect/Module_writerperfect.mk b/writerperfect/Module_writerperfect.mk
index d7ea1b939..db97aaff7 100644
--- a/writerperfect/Module_writerperfect.mk
+++ b/writerperfect/Module_writerperfect.mk
@@ -21,8 +21,8 @@ $(eval $(call gb_Module_Module,writerperfect))
 
 $(eval $(call gb_Module_add_targets,writerperfect,\
     $(if $(ENABLE_WASM_STRIP_BASIC_DRAW_MATH_IMPRESS),, \
-	Library_wpftdraw \
-	Library_wpftimpress \
+	$(if $(ENABLE_CDR),Library_wpftdraw) \
+	$(if $(ENABLE_ETONYEK),Library_wpftimpress) \
     ) \
 	$(if $(ENABLE_WASM_STRIP_CALC),, \
 	Library_wpftcalc \
